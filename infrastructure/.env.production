# ═══════════════════════════════════════════════════════════════════════════════
# VARIABILI D'AMBIENTE PRODUZIONE - IMPARAFACILE
# ═══════════════════════════════════════════════════════════════════════════════
# ATTENZIONE: Non committare questo file con valori reali!
# Usare secrets manager (AWS Secrets Manager, HashiCorp Vault, etc.)

# ─────────────────────────────────────────────────────────────────────────────
# SERVER
# ─────────────────────────────────────────────────────────────────────────────
NODE_ENV=production
PORT=4000
API_URL=https://api.imparafacile.it
FRONTEND_URL=https://imparafacile.it

# ─────────────────────────────────────────────────────────────────────────────
# DATABASE
# ─────────────────────────────────────────────────────────────────────────────
# Formato: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?schema=public&connection_limit=20
DATABASE_URL=postgresql://imparafacile:CHANGE_ME@db.imparafacile.it:5432/imparafacile?schema=public&connection_limit=20

# Pool connections
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20

# ─────────────────────────────────────────────────────────────────────────────
# REDIS
# ─────────────────────────────────────────────────────────────────────────────
REDIS_URL=redis://redis.imparafacile.it:6379
REDIS_PASSWORD=CHANGE_ME

# ─────────────────────────────────────────────────────────────────────────────
# JWT & AUTENTICAZIONE
# ─────────────────────────────────────────────────────────────────────────────
# Genera con: openssl rand -base64 64
JWT_SECRET=CHANGE_ME_WITH_SECURE_RANDOM_STRING_AT_LEAST_64_CHARS
JWT_EXPIRES_IN=15m
REFRESH_TOKEN_EXPIRES_IN=30d

# ─────────────────────────────────────────────────────────────────────────────
# COOKIES
# ─────────────────────────────────────────────────────────────────────────────
COOKIE_SECURE=true
COOKIE_SAMESITE=strict
COOKIE_DOMAIN=.imparafacile.it

# ─────────────────────────────────────────────────────────────────────────────
# CORS
# ─────────────────────────────────────────────────────────────────────────────
CORS_ORIGINS=https://imparafacile.it,https://www.imparafacile.it,https://app.imparafacile.it

# ─────────────────────────────────────────────────────────────────────────────
# EMAIL (SMTP)
# ─────────────────────────────────────────────────────────────────────────────
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=apikey
SMTP_PASS=CHANGE_ME_SENDGRID_API_KEY
EMAIL_FROM=noreply@imparafacile.it
EMAIL_FROM_NAME=ImparaFacile

# ─────────────────────────────────────────────────────────────────────────────
# OAUTH (Google)
# ─────────────────────────────────────────────────────────────────────────────
GOOGLE_CLIENT_ID=CHANGE_ME.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=CHANGE_ME
GOOGLE_CALLBACK_URL=https://api.imparafacile.it/api/auth/google/callback

# ─────────────────────────────────────────────────────────────────────────────
# OAUTH (Apple)
# ─────────────────────────────────────────────────────────────────────────────
APPLE_CLIENT_ID=it.imparafacile.app
APPLE_TEAM_ID=CHANGE_ME
APPLE_KEY_ID=CHANGE_ME
APPLE_PRIVATE_KEY_PATH=/secrets/apple-auth-key.p8

# ─────────────────────────────────────────────────────────────────────────────
# FIREBASE (Push Notifications)
# ─────────────────────────────────────────────────────────────────────────────
FIREBASE_PROJECT_ID=imparafacile-prod
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@imparafacile-prod.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nCHANGE_ME\n-----END PRIVATE KEY-----\n"

# ─────────────────────────────────────────────────────────────────────────────
# AWS S3 (Upload immagini)
# ─────────────────────────────────────────────────────────────────────────────
AWS_REGION=eu-south-1
AWS_ACCESS_KEY_ID=CHANGE_ME
AWS_SECRET_ACCESS_KEY=CHANGE_ME
S3_BUCKET=imparafacile-uploads
S3_CDN_URL=https://cdn.imparafacile.it

# ─────────────────────────────────────────────────────────────────────────────
# MONITORING
# ─────────────────────────────────────────────────────────────────────────────
SENTRY_DSN=https://CHANGE_ME@sentry.io/PROJECT_ID
LOG_LEVEL=info

# Grafana
GRAFANA_PASSWORD=CHANGE_ME

# ─────────────────────────────────────────────────────────────────────────────
# RATE LIMITING
# ─────────────────────────────────────────────────────────────────────────────
RATE_LIMIT_GLOBAL=100
RATE_LIMIT_AUTH=5
RATE_LIMIT_API=200

# ─────────────────────────────────────────────────────────────────────────────
# FEATURE FLAGS
# ─────────────────────────────────────────────────────────────────────────────
FEATURE_LIBROMERCATO=true
FEATURE_SOCIAL=true
FEATURE_TOURNAMENTS=false
FEATURE_AI_TUTOR=false
